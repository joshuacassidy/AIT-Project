@{
    ViewBag.Title = "Contact";
}
<h2 class="page-title">@ViewBag.Title</h2>
<hr />
<!--
<address>
    One Microsoft Way<br />
    Redmond, WA 98052-6399<br />
    <abbr title="Phone">P:</abbr>
    425.555.0100
</address>

<address>
    <strong>Support:</strong>   <a href="mailto:Support@example.com">Support@example.com</a><br />
    <strong>Marketing:</strong> <a href="mailto:Marketing@example.com">Marketing@example.com</a>


</address>
-->
<div class="form-custom">
    <h4 class="form-spacing error-message" id="divResult"></h4>
    <div class="form-group">
        <label class="col-md-3 control-label" for="Recipent">Recipent</label>
        <div class="col-md-9">
            <input type="text" id="Recipent" name="Recipent" class="form-control form-spacing" />
        </div>
    </div>
    <div class="form-group">
        <label for="Subject" class="col-md-3 control-label">Subject</label>
        <div class="col-md-9">
            <input type="text" class="form-control form-spacing" id="Subject" name="Subject" />
        </div>
    </div>
    <div class="form-group">
        <label for="Body" class="col-md-3 control-label">Message</label>
        <div class="col-md-9">
            <textarea id="Body" class="form-control form-spacing" name="Body" cols="30" rows="10"></textarea>
        </div>
    </div>
    <div class="col-md-offset-3 col-md-9">
        <button onclick="sendEmail()" class="btn btn-success button-custom" style="width: 100%;">Send</button>
        <div id="divProcessing">
            <p><img src="/Content/loading.gif">Processing, please wait . . .</p>
        </div>
    </div>
</div>
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        $("#divProcessing").hide();

        function sendEmail() {
            jQuery('#divResult').text('');

            $("#divProcessing").show();
            var uri = '/api/email';

            let data = {
                "Recipient": $('#Recipent').val(),
                "Subject": $('#Subject').val(),
                "Body": $('#Body').val()
            };


            $.post(uri, data)
                .done(function (response) {
                    jQuery('#divResult').text("");
                    jQuery('#divResult').removeClass("text-danger");
                    $("#divProcessing").hide();
                    jQuery('#divResult').addClass("text-success").text(response.Message);
                })
                .fail(function (response) {
                    jQuery('#divResult').text("");
                    jQuery('#divResult').removeClass("text-success");
                    $("#divProcessing").hide();
                    jQuery('#divResult').addClass("text-danger").text(response.responseJSON.Message);
                })
        }
    </script>
}
